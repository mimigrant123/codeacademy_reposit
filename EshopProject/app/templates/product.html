{% extends "base.html" %}
{% block title %}{{ product.name }} – Basket Shop{% endblock %}

{% block content %}
  <div class="row">
    <div class="col-md-6">
      <h3>Image Gallery</h3>

      {# Bootstrap 5 carousel; id must be unique per product #}
      <div id="carouselProduct{{ product.id }}" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
          {% for img in product.images %}
            <div class="carousel-item {% if loop.first %}active{% endif %}">
              <img
                src="{{ img.url() }}"
                class="d-block w-100"
                alt="{{ product.name }} image {{ loop.index }}"
                style="object-fit: contain; max-height: 400px;"
              >
            </div>
          {% endfor %}
        </div>

        {% if product.images|length > 1 %}
          <button class="carousel-control-prev" type="button"
                  data-bs-target="#carouselProduct{{ product.id }}" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
          </button>
          <button class="carousel-control-next" type="button"
                  data-bs-target="#carouselProduct{{ product.id }}" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
          </button>
        {% endif %}
      </div>
    </div>

    <div class="col-md-6">
      <h2>{{ product.name }}</h2>
      <p>{{ product.description }}</p>
      <h4>Price: € {{ "%.2f"|format(product.price) }}</h4>
      <a href="{{ url_for('shop.add_to_cart', product_id=product.id) }}" class="btn btn-success">
        Add to Cart
      </a>
    </div>
  </div>

  <hr>
  <a href="{{ url_for('shop.index') }}" class="btn btn-secondary mt-3">Back to Products</a>
{% endblock %}
